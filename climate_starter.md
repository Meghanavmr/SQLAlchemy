

```python
%matplotlib notebook
from matplotlib import style
style.use('fivethirtyeight')
import matplotlib.pyplot as plt
```


```python
import numpy as np
import pandas as pd
```


```python
import datetime as dt
```

# Reflect Tables into SQLAlchemy ORM


```python
# Python SQL toolkit and Object Relational Mapper
import sqlalchemy
from sqlalchemy.ext.automap import automap_base
from sqlalchemy.orm import Session
from sqlalchemy import create_engine, func
```


```python
#engine = create_engine("sqlite:///../Resources/hawaii.sqlite")
engine = create_engine("sqlite:///Resources/hawaii.sqlite")
```


```python
# reflect an existing database into a new model
Base = automap_base()
# reflect the tables
Base.prepare(engine, reflect=True)
```


```python
# We can view all of the classes that automap found
Base.classes.keys()
```




    ['measurement', 'station']




```python
# Save references to each table
Measurement = Base.classes.measurement
Station = Base.classes.station
```


```python
# Create our session (link) from Python to the DB
session = Session(engine)
```

# Exploratory Climate Analysis


```python
first_row = session.query(Measurement).first()
first_row.__dict__
```




    {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState at 0x22f85c912e8>,
     'date': '2010-01-01',
     'id': 1,
     'prcp': 0.08,
     'station': 'USC00519397',
     'tobs': 65.0}




```python
first_row = session.query(Station).first()
first_row.__dict__
```




    {'_sa_instance_state': <sqlalchemy.orm.state.InstanceState at 0x22f85c91c88>,
     'elevation': 3.0,
     'id': 1,
     'latitude': 21.2716,
     'longitude': -157.8168,
     'name': 'WAIKIKI 717.2, HI US',
     'station': 'USC00519397'}




```python
session.query(func.count(Measurement.id)).all()
```




    [(19550)]




```python
session.query(Measurement.date).order_by(Measurement.date.desc()).first()
#most recent data Aug 23, 2017
```




    ('2017-08-23')




```python
# Design a query to retrieve the last 12 months of precipitation data and plot the results
# Calculate the date 1 year ago from today
# Perform a query to retrieve the data and precipitation scores
# Save the query results as a Pandas DataFrame and set the index to the date column
# Sort the dataframe by date
# Use Pandas Plotting with Matplotlib to plot the data
# Rotate the xticks for the dates
##========
# Design a query to retrieve the last 12 months of precipitation data.
# Select only the date and prcp values.
# Load the query results into a Pandas DataFrame and set the index to the date column.
# Sort the DataFrame values by date
# Plot the results using the DataFrame plot method.
```


```python
sel = [Measurement.date, Measurement.prcp]
climate_data = session.query(*sel).\
    filter(Measurement.date > '2016-08-23').\
    order_by(Measurement.date).all()
climate_data
```




    [('2016-08-24', 0.08),
     ('2016-08-24', 2.15),
     ('2016-08-24', 2.28),
     ('2016-08-24', None),
     ('2016-08-24', 1.22),
     ('2016-08-24', 2.15),
     ('2016-08-24', 1.45),
     ('2016-08-25', 0.08),
     ('2016-08-25', 0.08),
     ('2016-08-25', 0.0),
     ('2016-08-25', 0.0),
     ('2016-08-25', 0.21),
     ('2016-08-25', 0.06),
     ('2016-08-25', 0.11),
     ('2016-08-26', 0.0),
     ('2016-08-26', 0.03),
     ('2016-08-26', 0.02),
     ('2016-08-26', 0.04),
     ('2016-08-26', 0.0),
     ('2016-08-26', 0.01),
     ('2016-08-27', 0.0),
     ('2016-08-27', 0.18),
     ('2016-08-27', 0.02),
     ('2016-08-27', 0.0),
     ('2016-08-27', 0.12),
     ('2016-08-27', None),
     ('2016-08-28', 0.01),
     ('2016-08-28', 0.14),
     ('2016-08-28', 0.14),
     ('2016-08-28', 0.14),
     ('2016-08-28', 0.6),
     ('2016-08-28', 2.07),
     ('2016-08-29', 0.0),
     ('2016-08-29', 0.17),
     ('2016-08-29', 0.04),
     ('2016-08-29', None),
     ('2016-08-29', 0.0),
     ('2016-08-29', 0.35),
     ('2016-08-29', 0.9),
     ('2016-08-30', 0.0),
     ('2016-08-30', 0.0),
     ('2016-08-30', 0.02),
     ('2016-08-30', 0.0),
     ('2016-08-30', 0.0),
     ('2016-08-30', 0.05),
     ('2016-08-31', 0.13),
     ('2016-08-31', 0.1),
     ('2016-08-31', None),
     ('2016-08-31', None),
     ('2016-08-31', 0.25),
     ('2016-08-31', 0.24),
     ('2016-08-31', 2.46),
     ('2016-09-01', 0.0),
     ('2016-09-01', 0.0),
     ('2016-09-01', 0.0),
     ('2016-09-01', None),
     ('2016-09-01', 0.02),
     ('2016-09-01', 0.01),
     ('2016-09-02', 0.0),
     ('2016-09-02', 0.02),
     ('2016-09-02', 0.19),
     ('2016-09-02', None),
     ('2016-09-02', None),
     ('2016-09-02', 0.01),
     ('2016-09-02', 0.03),
     ('2016-09-03', 0.0),
     ('2016-09-03', 0.07),
     ('2016-09-03', 0.08),
     ('2016-09-03', 0.12),
     ('2016-09-03', 1.0),
     ('2016-09-04', 0.03),
     ('2016-09-04', 0.03),
     ('2016-09-04', 0.74),
     ('2016-09-04', 0.14),
     ('2016-09-04', 0.44),
     ('2016-09-05', None),
     ('2016-09-05', 0.11),
     ('2016-09-05', None),
     ('2016-09-05', 0.02),
     ('2016-09-05', 0.03),
     ('2016-09-05', 0.18),
     ('2016-09-06', None),
     ('2016-09-06', 0.05),
     ('2016-09-06', 0.04),
     ('2016-09-06', 0.03),
     ('2016-09-06', 0.11),
     ('2016-09-06', 1.0),
     ('2016-09-07', 0.05),
     ('2016-09-07', 0.1),
     ('2016-09-07', 0.23),
     ('2016-09-07', 0.11),
     ('2016-09-07', 0.16),
     ('2016-09-07', 1.35),
     ('2016-09-08', 0.0),
     ('2016-09-08', 0.22),
     ('2016-09-08', 0.01),
     ('2016-09-08', None),
     ('2016-09-08', 0.01),
     ('2016-09-08', 0.07),
     ('2016-09-08', 0.15),
     ('2016-09-09', 0.03),
     ('2016-09-09', 0.01),
     ('2016-09-09', 0.29),
     ('2016-09-09', None),
     ('2016-09-09', 0.23),
     ('2016-09-09', 0.16),
     ('2016-09-09', 0.35),
     ('2016-09-10', 0.0),
     ('2016-09-10', 0.01),
     ('2016-09-10', 0.14),
     ('2016-09-10', 0.09),
     ('2016-09-10', 1.16),
     ('2016-09-11', 0.05),
     ('2016-09-11', 0.18),
     ('2016-09-11', 0.12),
     ('2016-09-11', 0.3),
     ('2016-09-11', 0.6),
     ('2016-09-12', 0.0),
     ('2016-09-12', 0.04),
     ('2016-09-12', None),
     ('2016-09-12', None),
     ('2016-09-12', 0.15),
     ('2016-09-12', 0.31),
     ('2016-09-12', 1.04),
     ('2016-09-13', 0.02),
     ('2016-09-13', 0.37),
     ('2016-09-13', 0.32),
     ('2016-09-13', None),
     ('2016-09-13', 0.46),
     ('2016-09-13', 0.34),
     ('2016-09-13', 1.2),
     ('2016-09-14', 1.32),
     ('2016-09-14', 0.9),
     ('2016-09-14', 1.84),
     ('2016-09-14', None),
     ('2016-09-14', 1.19),
     ('2016-09-14', 2.33),
     ('2016-09-14', 6.7),
     ('2016-09-15', 0.42),
     ('2016-09-15', 0.12),
     ('2016-09-15', 0.07),
     ('2016-09-15', None),
     ('2016-09-15', 0.17),
     ('2016-09-15', 0.83),
     ('2016-09-15', 3.35),
     ('2016-09-16', 0.06),
     ('2016-09-16', 0.01),
     ('2016-09-16', 0.07),
     ('2016-09-16', 0.0),
     ('2016-09-16', 0.01),
     ('2016-09-16', 0.06),
     ('2016-09-16', 0.61),
     ('2016-09-17', 0.05),
     ('2016-09-17', 0.04),
     ('2016-09-17', 0.0),
     ('2016-09-17', 0.36),
     ('2016-09-17', 0.23),
     ('2016-09-18', 0.0),
     ('2016-09-18', 0.0),
     ('2016-09-18', 0.04),
     ('2016-09-18', 0.07),
     ('2016-09-18', 0.42),
     ('2016-09-19', 0.0),
     ('2016-09-19', 0.01),
     ('2016-09-19', None),
     ('2016-09-19', None),
     ('2016-09-19', 0.05),
     ('2016-09-19', 0.01),
     ('2016-09-19', 0.25),
     ('2016-09-20', 0.0),
     ('2016-09-20', 0.09),
     ('2016-09-20', 0.25),
     ('2016-09-20', 0.0),
     ('2016-09-20', 0.04),
     ('2016-09-20', 0.22),
     ('2016-09-20', 0.43),
     ('2016-09-21', 0.0),
     ('2016-09-21', 0.06),
     ('2016-09-21', 0.02),
     ('2016-09-21', 0.0),
     ('2016-09-21', 0.07),
     ('2016-09-21', 1.02),
     ('2016-09-22', 0.02),
     ('2016-09-22', 0.09),
     ('2016-09-22', 0.17),
     ('2016-09-22', 0.06),
     ('2016-09-22', 0.01),
     ('2016-09-22', 0.34),
     ('2016-09-22', 0.75),
     ('2016-09-23', 0.0),
     ('2016-09-23', 0.15),
     ('2016-09-23', 0.15),
     ('2016-09-23', 0.0),
     ('2016-09-23', 0.0),
     ('2016-09-23', 0.94),
     ('2016-09-23', 0.33),
     ('2016-09-24', 0.0),
     ('2016-09-24', 0.0),
     ('2016-09-24', 0.0),
     ('2016-09-24', 0.0),
     ('2016-09-24', 0.01),
     ('2016-09-24', 0.27),
     ('2016-09-25', 0.0),
     ('2016-09-25', 0.02),
     ('2016-09-25', 0.0),
     ('2016-09-25', 0.0),
     ('2016-09-25', 0.03),
     ('2016-09-25', 0.04),
     ('2016-09-26', 0.06),
     ('2016-09-26', 0.06),
     ('2016-09-26', 0.02),
     ('2016-09-26', None),
     ('2016-09-26', 0.34),
     ('2016-09-26', 0.17),
     ('2016-09-26', 1.02),
     ('2016-09-27', 0.02),
     ('2016-09-27', 0.12),
     ('2016-09-27', 0.0),
     ('2016-09-27', 0.05),
     ('2016-09-27', 0.17),
     ('2016-09-27', 1.0),
     ('2016-09-28', 0.0),
     ('2016-09-28', 0.08),
     ('2016-09-28', 0.0),
     ('2016-09-28', 0.0),
     ('2016-09-28', 0.0),
     ('2016-09-28', 0.0),
     ('2016-09-28', 0.05),
     ('2016-09-29', 0.0),
     ('2016-09-29', 0.49),
     ('2016-09-29', 0.2),
     ('2016-09-29', 0.04),
     ('2016-09-29', 0.18),
     ('2016-09-29', 0.59),
     ('2016-09-29', 1.49),
     ('2016-09-30', 0.0),
     ('2016-09-30', 0.31),
     ('2016-09-30', 0.06),
     ('2016-09-30', None),
     ('2016-09-30', 0.15),
     ('2016-09-30', 0.25),
     ('2016-09-30', 0.38),
     ('2016-10-01', 0.0),
     ('2016-10-01', 0.14),
     ('2016-10-01', 0.08),
     ('2016-10-01', 0.07),
     ('2016-10-01', 0.14),
     ('2016-10-01', 1.02),
     ('2016-10-02', 0.0),
     ('2016-10-02', 0.02),
     ('2016-10-02', 0.03),
     ('2016-10-02', 0.0),
     ('2016-10-02', 0.06),
     ('2016-10-02', 0.61),
     ('2016-10-03', 0.0),
     ('2016-10-03', 0.04),
     ('2016-10-03', 0.03),
     ('2016-10-03', None),
     ('2016-10-03', 0.0),
     ('2016-10-03', 0.16),
     ('2016-10-03', 0.46),
     ('2016-10-04', 0.0),
     ('2016-10-04', 0.0),
     ('2016-10-04', 0.0),
     ('2016-10-04', None),
     ('2016-10-04', 0.0),
     ('2016-10-04', 0.03),
     ('2016-10-04', 3.46),
     ('2016-10-05', 0.0),
     ('2016-10-05', 0.0),
     ('2016-10-05', 0.0),
     ('2016-10-05', None),
     ('2016-10-05', 0.0),
     ('2016-10-05', 0.01),
     ('2016-10-05', 0.81),
     ('2016-10-06', 0.0),
     ('2016-10-06', 0.05),
     ('2016-10-06', 0.0),
     ('2016-10-06', 0.07),
     ('2016-10-06', 0.0),
     ('2016-10-06', 0.0),
     ('2016-10-06', 0.04),
     ('2016-10-07', 0.0),
     ('2016-10-07', 0.0),
     ('2016-10-07', 0.0),
     ('2016-10-07', None),
     ('2016-10-07', 0.0),
     ('2016-10-07', 0.0),
     ('2016-10-07', 0.01),
     ('2016-10-08', 0.0),
     ('2016-10-08', 0.0),
     ('2016-10-08', 0.0),
     ('2016-10-08', 0.0),
     ('2016-10-08', 0.04),
     ('2016-10-09', 0.0),
     ('2016-10-09', 0.0),
     ('2016-10-09', 0.0),
     ('2016-10-09', 0.0),
     ('2016-10-09', 0.0),
     ('2016-10-10', 0.0),
     ('2016-10-10', 0.0),
     ('2016-10-10', None),
     ('2016-10-10', 0.0),
     ('2016-10-10', 0.0),
     ('2016-10-10', 0.0),
     ('2016-10-11', 0.0),
     ('2016-10-11', 0.02),
     ('2016-10-11', 0.04),
     ('2016-10-11', None),
     ('2016-10-11', 0.0),
     ('2016-10-11', 0.28),
     ('2016-10-11', 0.35),
     ('2016-10-12', 0.0),
     ('2016-10-12', 0.03),
     ('2016-10-12', 0.0),
     ('2016-10-12', 0.0),
     ('2016-10-12', 0.03),
     ('2016-10-12', 0.02),
     ('2016-10-13', 0.0),
     ('2016-10-13', 0.0),
     ('2016-10-13', 0.02),
     ('2016-10-13', None),
     ('2016-10-13', 0.0),
     ('2016-10-13', 0.0),
     ('2016-10-13', 0.06),
     ('2016-10-14', 0.0),
     ('2016-10-14', 0.0),
     ('2016-10-14', 0.0),
     ('2016-10-14', 0.0),
     ('2016-10-14', 0.0),
     ('2016-10-14', 0.0),
     ('2016-10-15', 0.0),
     ('2016-10-15', 0.0),
     ('2016-10-15', 0.02),
     ('2016-10-15', 0.0),
     ('2016-10-15', 0.04),
     ('2016-10-15', 0.33),
     ('2016-10-16', 0.0),
     ('2016-10-16', 0.0),
     ('2016-10-16', 0.0),
     ('2016-10-16', 0.0),
     ('2016-10-16', 0.0),
     ('2016-10-17', 0.01),
     ('2016-10-17', 0.03),
     ('2016-10-17', None),
     ('2016-10-17', None),
     ('2016-10-17', 0.12),
     ('2016-10-17', 0.01),
     ('2016-10-17', 0.38),
     ('2016-10-18', 0.0),
     ('2016-10-18', 0.05),
     ('2016-10-18', 0.03),
     ('2016-10-18', None),
     ('2016-10-18', 0.02),
     ('2016-10-18', 0.02),
     ('2016-10-18', 0.48),
     ('2016-10-19', 0.0),
     ('2016-10-19', 0.06),
     ('2016-10-19', 0.0),
     ('2016-10-19', None),
     ('2016-10-19', 0.0),
     ('2016-10-19', 0.11),
     ('2016-10-19', 0.0),
     ('2016-10-20', 0.0),
     ('2016-10-20', 0.0),
     ('2016-10-20', 0.01),
     ('2016-10-20', None),
     ('2016-10-20', 0.0),
     ('2016-10-20', 1.0),
     ('2016-10-21', 0.05),
     ('2016-10-21', 0.15),
     ('2016-10-21', 0.03),
     ('2016-10-21', None),
     ('2016-10-21', None),
     ('2016-10-21', 0.0),
     ('2016-10-21', 0.09),
     ('2016-10-22', 0.15),
     ('2016-10-22', 0.1),
     ('2016-10-22', 0.0),
     ('2016-10-22', 0.15),
     ('2016-10-22', 1.37),
     ('2016-10-23', 0.01),
     ('2016-10-23', 0.01),
     ('2016-10-23', None),
     ('2016-10-23', 0.0),
     ('2016-10-23', 0.02),
     ('2016-10-23', 0.24),
     ('2016-10-24', 0.0),
     ('2016-10-24', 0.0),
     ('2016-10-24', 0.01),
     ('2016-10-24', None),
     ('2016-10-24', 0.0),
     ('2016-10-24', 0.08),
     ('2016-10-24', 0.7),
     ('2016-10-25', 0.03),
     ('2016-10-25', 0.04),
     ('2016-10-25', 0.0),
     ('2016-10-25', 0.4),
     ('2016-10-25', 0.12),
     ('2016-10-25', 0.11),
     ('2016-10-25', 0.4),
     ('2016-10-26', 0.0),
     ('2016-10-26', 0.06),
     ('2016-10-26', 0.2),
     ('2016-10-26', 0.02),
     ('2016-10-26', 0.01),
     ('2016-10-26', 0.0),
     ('2016-10-27', 0.0),
     ('2016-10-27', 0.11),
     ('2016-10-27', 0.2),
     ('2016-10-27', None),
     ('2016-10-27', 0.08),
     ('2016-10-27', 0.22),
     ('2016-10-27', 1.25),
     ('2016-10-28', 0.0),
     ('2016-10-28', 0.02),
     ('2016-10-28', 0.07),
     ('2016-10-28', None),
     ('2016-10-28', 0.06),
     ('2016-10-28', 0.05),
     ('2016-10-28', 0.37),
     ('2016-10-29', 0.0),
     ('2016-10-29', 0.02),
     ('2016-10-29', 0.26),
     ('2016-10-29', 0.01),
     ('2016-10-29', 0.1),
     ('2016-10-29', 0.25),
     ('2016-10-30', 0.24),
     ('2016-10-30', 0.1),
     ('2016-10-30', 0.14),
     ('2016-10-30', 0.0),
     ('2016-10-30', 0.16),
     ('2016-10-30', 0.95),
     ('2016-10-31', 0.03),
     ('2016-10-31', 0.03),
     ('2016-10-31', 0.0),
     ('2016-10-31', None),
     ('2016-10-31', 0.13),
     ('2016-10-31', 0.07),
     ('2016-10-31', 1.35),
     ('2016-11-01', 0.0),
     ('2016-11-01', 0.01),
     ('2016-11-01', 0.0),
     ('2016-11-01', 0.01),
     ('2016-11-01', 0.1),
     ('2016-11-01', 0.09),
     ('2016-11-02', 0.0),
     ('2016-11-02', 0.0),
     ('2016-11-02', 0.0),
     ('2016-11-02', 0.0),
     ('2016-11-02', 0.0),
     ('2016-11-02', 0.04),
     ('2016-11-03', 0.0),
     ('2016-11-03', 0.0),
     ('2016-11-03', 0.0),
     ('2016-11-03', 0.0),
     ('2016-11-03', 0.0),
     ('2016-11-03', 0.02),
     ('2016-11-04', 0.0),
     ('2016-11-04', 0.0),
     ('2016-11-04', 0.0),
     ('2016-11-04', None),
     ('2016-11-04', 0.0),
     ('2016-11-04', 0.0),
     ('2016-11-04', 0.06),
     ('2016-11-05', 0.0),
     ('2016-11-05', 0.02),
     ('2016-11-05', 0.0),
     ('2016-11-05', 0.02),
     ('2016-11-05', 0.03),
     ('2016-11-05', 0.38),
     ('2016-11-06', 0.0),
     ('2016-11-06', 0.02),
     ('2016-11-06', 0.0),
     ('2016-11-06', 0.0),
     ('2016-11-06', 0.01),
     ('2016-11-06', 0.05),
     ('2016-11-07', 0.0),
     ('2016-11-07', 0.0),
     ('2016-11-07', 0.13),
     ('2016-11-07', None),
     ('2016-11-07', 0.0),
     ('2016-11-07', 0.0),
     ('2016-11-07', 0.05),
     ('2016-11-08', 0.07),
     ('2016-11-08', 0.14),
     ('2016-11-08', 0.02),
     ('2016-11-08', 0.15),
     ('2016-11-08', 0.21),
     ('2016-11-08', 0.53),
     ('2016-11-09', 0.0),
     ('2016-11-09', 0.08),
     ('2016-11-09', 0.17),
     ('2016-11-09', 0.0),
     ('2016-11-09', 0.0),
     ('2016-11-09', 0.11),
     ('2016-11-09', 0.04),
     ('2016-11-10', 0.0),
     ('2016-11-10', 0.0),
     ('2016-11-10', 0.0),
     ('2016-11-10', 0.0),
     ('2016-11-10', 0.0),
     ('2016-11-10', 0.01),
     ('2016-11-11', 0.0),
     ('2016-11-11', 0.0),
     ('2016-11-11', 0.0),
     ('2016-11-11', 0.0),
     ('2016-11-11', 0.0),
     ('2016-11-11', 0.0),
     ('2016-11-12', 0.0),
     ('2016-11-12', 0.0),
     ('2016-11-12', 0.0),
     ('2016-11-12', 0.0),
     ('2016-11-12', 0.0),
     ('2016-11-12', 0.0),
     ('2016-11-13', 0.0),
     ('2016-11-13', 0.0),
     ('2016-11-13', 0.0),
     ('2016-11-13', 0.0),
     ('2016-11-13', 0.0),
     ('2016-11-13', 0.0),
     ('2016-11-14', 0.0),
     ('2016-11-14', 0.06),
     ('2016-11-14', 0.05),
     ('2016-11-14', 0.02),
     ('2016-11-14', 0.0),
     ('2016-11-14', 0.0),
     ('2016-11-14', 0.02),
     ('2016-11-15', 0.0),
     ('2016-11-15', 0.0),
     ('2016-11-15', 0.0),
     ('2016-11-15', None),
     ('2016-11-15', 0.0),
     ('2016-11-15', 0.0),
     ('2016-11-15', 0.05),
     ('2016-11-16', 0.0),
     ('2016-11-16', 0.14),
     ('2016-11-16', 0.18),
     ('2016-11-16', None),
     ('2016-11-16', 0.07),
     ('2016-11-16', 0.24),
     ('2016-11-16', 0.91),
     ('2016-11-17', 0.0),
     ('2016-11-17', 0.03),
     ('2016-11-17', 0.0),
     ('2016-11-17', None),
     ('2016-11-17', 0.0),
     ('2016-11-17', 0.01),
     ('2016-11-17', 0.02),
     ('2016-11-18', 0.0),
     ('2016-11-18', 0.01),
     ('2016-11-18', None),
     ('2016-11-18', 0.02),
     ('2016-11-18', 0.0),
     ('2016-11-19', 0.03),
     ('2016-11-19', 0.11),
     ('2016-11-19', 0.13),
     ('2016-11-19', 0.11),
     ('2016-11-20', 0.05),
     ('2016-11-20', 0.11),
     ('2016-11-20', 0.4),
     ('2016-11-20', 0.39),
     ('2016-11-20', None),
     ('2016-11-21', 0.01),
     ('2016-11-21', 0.02),
     ('2016-11-21', None),
     ('2016-11-21', 0.07),
     ('2016-11-21', 0.11),
     ('2016-11-21', 2.87),
     ('2016-11-22', 0.13),
     ('2016-11-22', 0.41),
     ('2016-11-22', None),
     ('2016-11-22', None),
     ('2016-11-22', 0.31),
     ('2016-11-22', 2.05),
     ('2016-11-22', 2.11),
     ('2016-11-23', 0.14),
     ('2016-11-23', 0.03),
     ('2016-11-23', None),
     ('2016-11-23', 0.03),
     ('2016-11-23', 0.25),
     ('2016-11-23', 0.22),
     ('2016-11-24', 0.05),
     ('2016-11-24', 0.2),
     ('2016-11-24', 0.21),
     ('2016-11-24', 0.3),
     ('2016-11-24', 0.72),
     ('2016-11-25', 0.05),
     ('2016-11-25', 0.05),
     ('2016-11-25', None),
     ('2016-11-25', 0.11),
     ('2016-11-25', 0.08),
     ('2016-11-25', 1.03),
     ('2016-11-26', 0.05),
     ('2016-11-26', 0.05),
     ('2016-11-26', 0.02),
     ('2016-11-26', 0.03),
     ('2016-11-26', 0.06),
     ('2016-11-26', 0.3),
     ('2016-11-27', 0.0),
     ('2016-11-27', 0.06),
     ('2016-11-27', 0.03),
     ('2016-11-27', 0.0),
     ('2016-11-27', 0.17),
     ('2016-11-27', 0.29),
     ('2016-11-28', 0.01),
     ('2016-11-28', 0.02),
     ('2016-11-28', 0.0),
     ('2016-11-28', None),
     ('2016-11-28', 0.0),
     ('2016-11-28', 0.0),
     ('2016-11-28', 0.69),
     ('2016-11-29', 0.0),
     ('2016-11-29', 0.04),
     ('2016-11-29', 0.04),
     ('2016-11-29', None),
     ('2016-11-29', 0.06),
     ('2016-11-29', 0.09),
     ('2016-11-29', 0.2),
     ('2016-11-30', 0.14),
     ('2016-11-30', 0.05),
     ('2016-11-30', 0.03),
     ('2016-11-30', None),
     ('2016-11-30', 0.0),
     ('2016-11-30', 0.05),
     ('2016-11-30', 0.79),
     ('2016-12-01', 0.12),
     ('2016-12-01', 0.33),
     ('2016-12-01', 0.07),
     ('2016-12-01', None),
     ('2016-12-01', 0.16),
     ('2016-12-01', 0.37),
     ('2016-12-01', 0.72),
     ('2016-12-02', 0.03),
     ('2016-12-02', 0.3),
     ('2016-12-02', 0.4),
     ('2016-12-02', None),
     ('2016-12-02', 0.01),
     ('2016-12-02', 0.35),
     ('2016-12-02', 1.27),
     ('2016-12-03', 0.0),
     ('2016-12-03', 0.04),
     ('2016-12-03', 0.26),
     ('2016-12-03', 0.02),
     ('2016-12-03', 0.77),
     ('2016-12-03', 1.62),
     ('2016-12-04', 0.03),
     ('2016-12-04', 0.1),
     ('2016-12-04', 0.0),
     ('2016-12-04', 0.32),
     ('2016-12-04', 0.04),
     ('2016-12-04', 0.31),
     ('2016-12-05', 0.43),
     ('2016-12-05', 0.34),
     ('2016-12-05', 0.2),
     ('2016-12-05', None),
     ('2016-12-05', 0.45),
     ('2016-12-05', 0.22),
     ('2016-12-05', 1.6),
     ('2016-12-06', 0.02),
     ('2016-12-06', 0.02),
     ('2016-12-06', None),
     ('2016-12-06', 0.0),
     ('2016-12-06', 0.0),
     ('2016-12-06', 0.0),
     ('2016-12-07', 0.0),
     ('2016-12-07', 0.17),
     ('2016-12-07', None),
     ('2016-12-07', None),
     ('2016-12-07', 0.07),
     ('2016-12-07', 0.12),
     ('2016-12-07', 0.02),
     ('2016-12-08', 0.03),
     ('2016-12-08', 0.03),
     ('2016-12-08', 0.02),
     ('2016-12-08', 0.27),
     ('2016-12-08', 0.01),
     ('2016-12-08', 0.07),
     ('2016-12-08', 0.03),
     ('2016-12-09', 0.52),
     ('2016-12-09', 0.34),
     ('2016-12-09', 0.26),
     ('2016-12-09', None),
     ('2016-12-09', 0.31),
     ('2016-12-09', 0.42),
     ('2016-12-10', 0.05),
     ('2016-12-10', 0.02),
     ('2016-12-10', 0.0),
     ('2016-12-10', None),
     ('2016-12-10', 0.02),
     ('2016-12-10', 0.04),
     ('2016-12-11', 0.04),
     ('2016-12-11', 0.02),
     ('2016-12-11', 0.06),
     ('2016-12-11', 0.0),
     ('2016-12-11', 0.13),
     ('2016-12-12', 0.01),
     ('2016-12-12', 0.01),
     ('2016-12-12', None),
     ('2016-12-12', 0.02),
     ('2016-12-12', 0.0),
     ('2016-12-12', 0.0),
     ('2016-12-12', 0.01),
     ('2016-12-13', 0.05),
     ('2016-12-13', 0.1),
     ('2016-12-13', 0.34),
     ('2016-12-13', None),
     ('2016-12-13', 0.15),
     ('2016-12-13', 0.04),
     ('2016-12-13', 0.09),
     ('2016-12-14', 0.03),
     ('2016-12-14', 0.05),
     ('2016-12-14', 0.12),
     ('2016-12-14', None),
     ('2016-12-14', 0.05),
     ('2016-12-14', 0.92),
     ('2016-12-14', 0.33),
     ('2016-12-15', 0.0),
     ('2016-12-15', 0.02),
     ('2016-12-15', 0.07),
     ('2016-12-15', None),
     ('2016-12-15', 0.0),
     ('2016-12-15', 0.14),
     ('2016-12-15', 0.03),
     ('2016-12-16', 0.0),
     ('2016-12-16', 0.01),
     ('2016-12-16', 0.0),
     ('2016-12-16', None),
     ('2016-12-16', 0.0),
     ('2016-12-16', 0.03),
     ('2016-12-16', 0.0),
     ('2016-12-17', 0.01),
     ('2016-12-17', 0.11),
     ('2016-12-17', 0.0),
     ('2016-12-17', 0.16),
     ('2016-12-17', 0.07),
     ('2016-12-18', 0.13),
     ('2016-12-18', 0.29),
     ('2016-12-18', 0.04),
     ('2016-12-18', 0.27),
     ('2016-12-18', 0.16),
     ('2016-12-18', None),
     ('2016-12-19', 0.01),
     ('2016-12-19', 0.21),
     ('2016-12-19', 0.0),
     ('2016-12-19', None),
     ('2016-12-19', 0.02),
     ('2016-12-19', 0.03),
     ('2016-12-19', 0.15),
     ('2016-12-20', 0.0),
     ('2016-12-20', 0.02),
     ('2016-12-20', 0.0),
     ('2016-12-20', None),
     ('2016-12-20', 0.01),
     ('2016-12-20', 0.0),
     ('2016-12-20', 0.0),
     ('2016-12-21', 0.0),
     ('2016-12-21', 0.03),
     ('2016-12-21', 0.09),
     ('2016-12-21', 0.06),
     ('2016-12-21', 0.06),
     ('2016-12-21', 0.11),
     ('2016-12-21', 0.55),
     ('2016-12-22', 0.01),
     ('2016-12-22', 0.17),
     ('2016-12-22', 0.05),
     ('2016-12-22', None),
     ('2016-12-22', 0.14),
     ('2016-12-22', 0.86),
     ('2016-12-22', 1.24),
     ('2016-12-23', 0.01),
     ('2016-12-23', 0.1),
     ('2016-12-23', 0.03),
     ('2016-12-23', None),
     ('2016-12-23', 0.02),
     ('2016-12-23', 0.24),
     ('2016-12-23', 0.83),
     ('2016-12-24', 0.01),
     ('2016-12-24', 0.14),
     ('2016-12-24', 0.13),
     ('2016-12-24', 0.06),
     ('2016-12-24', 0.2),
     ('2016-12-24', 1.08),
     ('2016-12-25', 0.0),
     ('2016-12-25', 0.03),
     ('2016-12-25', 0.0),
     ('2016-12-25', 0.02),
     ('2016-12-25', 0.38),
     ('2016-12-26', 0.02),
     ('2016-12-26', 0.26),
     ('2016-12-26', None),
     ('2016-12-26', 0.06),
     ('2016-12-26', 0.22),
     ('2016-12-26', 1.48),
     ('2016-12-27', 0.0),
     ('2016-12-27', 0.03),
     ('2016-12-27', 0.02),
     ('2016-12-27', 0.0),
     ('2016-12-27', 0.05),
     ('2016-12-27', 0.14),
     ('2016-12-28', 0.02),
     ('2016-12-28', 0.09),
     ('2016-12-28', 0.01),
     ('2016-12-28', None),
     ('2016-12-28', 0.06),
     ('2016-12-28', 0.09),
     ('2016-12-28', 0.14),
     ('2016-12-29', 0.04),
     ('2016-12-29', 0.18),
     ('2016-12-29', 0.56),
     ('2016-12-29', None),
     ('2016-12-29', 0.05),
     ('2016-12-29', 0.52),
     ('2016-12-29', 1.03),
     ('2016-12-30', 0.12),
     ('2016-12-30', 0.21),
     ('2016-12-30', 0.29),
     ('2016-12-30', None),
     ('2016-12-30', 0.07),
     ('2016-12-30', 0.29),
     ('2016-12-30', 2.37),
     ('2016-12-31', 0.01),
     ('2016-12-31', 0.62),
     ('2016-12-31', 0.36),
     ('2016-12-31', 0.25),
     ('2016-12-31', 0.9),
     ('2017-01-01', 0.0),
     ('2017-01-01', 0.29),
     ('2017-01-01', 0.0),
     ('2017-01-01', None),
     ('2017-01-01', 0.03),
     ('2017-01-01', 0.03),
     ('2017-01-02', 0.0),
     ('2017-01-02', 0.0),
     ('2017-01-02', 0.01),
     ('2017-01-02', 0.01),
     ('2017-01-02', 0.0),
     ('2017-01-03', 0.0),
     ('2017-01-03', 0.0),
     ('2017-01-03', 0.0),
     ('2017-01-03', None),
     ('2017-01-03', 0.0),
     ('2017-01-03', 0.0),
     ('2017-01-04', 0.0),
     ('2017-01-04', 0.0),
     ('2017-01-04', 0.0),
     ('2017-01-04', 0.18),
     ('2017-01-04', 0.0),
     ('2017-01-04', 0.0),
     ('2017-01-05', 0.0),
     ('2017-01-05', 0.0),
     ('2017-01-05', 0.0),
     ('2017-01-05', 0.42),
     ('2017-01-05', 0.06),
     ('2017-01-05', 0.47),
     ('2017-01-06', 0.0),
     ('2017-01-06', 0.0),
     ('2017-01-06', 0.59),
     ('2017-01-06', 0.01),
     ('2017-01-06', 0.1),
     ('2017-01-06', 0.1),
     ('2017-01-07', 0.0),
     ('2017-01-07', 0.06),
     ('2017-01-07', 0.0),
     ('2017-01-07', 0.0),
     ('2017-01-07', 0.0),
     ('2017-01-07', 0.0),
     ('2017-01-08', 0.0),
     ('2017-01-08', 0.0),
     ('2017-01-08', 0.03),
     ('2017-01-08', 0.0),
     ('2017-01-08', 0.0),
     ('2017-01-08', 0.03),
     ('2017-01-09', 0.0),
     ('2017-01-09', 0.0),
     ('2017-01-09', 0.0),
     ('2017-01-09', None),
     ('2017-01-09', 0.0),
     ('2017-01-09', 0.0),
     ('2017-01-09', 0.0),
     ('2017-01-10', 0.0),
     ('2017-01-10', 0.0),
     ('2017-01-10', 0.0),
     ('2017-01-10', None),
     ('2017-01-10', 0.0),
     ('2017-01-10', 0.0),
     ('2017-01-10', 0.0),
     ('2017-01-11', 0.0),
     ('2017-01-11', 0.0),
     ('2017-01-11', 0.0),
     ('2017-01-11', None),
     ('2017-01-11', 0.0),
     ('2017-01-11', 0.0),
     ('2017-01-12', 0.0),
     ('2017-01-12', 0.0),
     ('2017-01-12', None),
     ('2017-01-12', None),
     ('2017-01-12', 0.0),
     ('2017-01-12', 0.0),
     ('2017-01-13', 0.0),
     ('2017-01-13', 0.0),
     ('2017-01-13', None),
     ('2017-01-13', None),
     ('2017-01-13', 0.0),
     ('2017-01-13', 0.0),
     ('2017-01-14', 0.0),
     ('2017-01-14', 0.0),
     ('2017-01-14', 0.0),
     ('2017-01-14', 0.01),
     ('2017-01-14', 0.0),
     ('2017-01-15', 0.0),
     ('2017-01-15', 0.0),
     ('2017-01-15', None),
     ('2017-01-15', 0.0),
     ('2017-01-15', 0.01),
     ('2017-01-16', 0.0),
     ('2017-01-16', 0.0),
     ('2017-01-16', None),
     ('2017-01-16', 0.0),
     ('2017-01-16', 0.0),
     ('2017-01-16', 0.0),
     ('2017-01-17', 0.0),
     ('2017-01-17', 0.0),
     ('2017-01-17', 0.0),
     ('2017-01-17', 0.0),
     ('2017-01-17', 0.0),
     ('2017-01-17', 0.0),
     ('2017-01-18', 0.0),
     ('2017-01-18', 0.0),
     ('2017-01-18', 0.0),
     ('2017-01-18', 0.0),
     ('2017-01-18', None),
     ('2017-01-18', 0.0),
     ('2017-01-18', 0.07),
     ('2017-01-19', 0.0),
     ('2017-01-19', 0.0),
     ('2017-01-19', 0.0),
     ('2017-01-19', None),
     ('2017-01-19', 0.0),
     ('2017-01-19', 0.02),
     ('2017-01-19', 0.0),
     ('2017-01-20', 0.0),
     ('2017-01-20', 0.0),
     ('2017-01-20', 0.0),
     ('2017-01-20', None),
     ('2017-01-20', 0.0),
     ('2017-01-20', 0.0),
     ('2017-01-20', 0.0),
     ('2017-01-21', 0.0),
     ('2017-01-21', 0.04),
     ('2017-01-21', 0.02),
     ('2017-01-21', 0.11),
     ('2017-01-21', 0.03),
     ('2017-01-21', 0.08),
     ('2017-01-22', 0.16),
     ('2017-01-22', 0.01),
     ('2017-01-22', 0.04),
     ('2017-01-22', 0.09),
     ('2017-01-22', 0.72),
     ('2017-01-23', 0.0),
     ('2017-01-23', 0.08),
     ('2017-01-23', None),
     ('2017-01-23', None),
     ('2017-01-23', 0.0),
     ('2017-01-23', 0.01),
     ('2017-01-23', 0.85),
     ('2017-01-24', 0.04),
     ('2017-01-24', 0.15),
     ('2017-01-24', None),
     ('2017-01-24', 0.08),
     ('2017-01-24', 0.13),
     ('2017-01-24', 1.85),
     ('2017-01-25', 0.03),
     ('2017-01-25', 0.12),
     ('2017-01-25', None),
     ('2017-01-25', None),
     ('2017-01-25', 0.0),
     ('2017-01-25', 0.79),
     ('2017-01-25', 2.64),
     ('2017-01-26', 0.0),
     ('2017-01-26', 0.0),
     ('2017-01-26', 0.01),
     ('2017-01-26', 0.0),
     ('2017-01-26', 0.0),
     ('2017-01-26', 0.0),
     ('2017-01-26', 0.1),
     ('2017-01-27', 0.0),
     ('2017-01-27', 0.0),
     ('2017-01-27', 0.0),
     ('2017-01-27', 0.0),
     ('2017-01-27', 0.0),
     ('2017-01-27', 0.03),
     ('2017-01-27', 0.03),
     ('2017-01-28', 0.0),
     ('2017-01-28', 0.14),
     ('2017-01-28', 0.0),
     ('2017-01-28', 0.0),
     ('2017-01-28', 0.0),
     ('2017-01-29', 0.18),
     ('2017-01-29', 0.0),
     ...]




```python
len(climate_data)
# 2223
```




    2223




```python
climate_df = pd.DataFrame(climate_data, columns=['date', 'Precipitation'])
climate_df = climate_df.sort_values('date', ascending=True)
climate_df.set_index('date', inplace=True)
climate_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precipitation</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-08-24</th>
      <td>0.08</td>
    </tr>
    <tr>
      <th>2016-08-24</th>
      <td>2.15</td>
    </tr>
    <tr>
      <th>2016-08-24</th>
      <td>2.28</td>
    </tr>
    <tr>
      <th>2016-08-24</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2016-08-24</th>
      <td>1.22</td>
    </tr>
  </tbody>
</table>
</div>




```python
# climate_df_srt_ind = pd.DataFrame(climate_df_srt, columns=['date', 'Precipitation'])
# climate_df_srt.set_index('date', inplace=True)
# climate_df_srt_ind.head()
```


```python
climate_df.plot(kind ="line", figsize=(8,6))
plt.yticks(np.arange(0, 4.5, step=0.5))
plt.legend(loc="upper left")
plt.tight_layout()
plt.show()

plt.savefig("hawaii_vacay.png",bbox_inches="tight")
```


    <IPython.core.display.Javascript object>



<div id='a422d4ba-99b0-4fdb-96f5-749ec9a02385'></div>



```python
# Use Pandas to calcualte the summary statistics for the precipitation data
climate_df.describe()

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Precipitation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2015.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.176462</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.460288</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.020000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.130000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6.700000</td>
    </tr>
  </tbody>
</table>
</div>




```python
# How many stations are available in this dataset?



session.query(func.count(Station.station)).all()


```




    [(9)]




```python
session.query(Measurement.station, Station.station).limit(10).all()
```




    [('USC00519397', 'USC00519397'),
     ('USC00519397', 'USC00513117'),
     ('USC00519397', 'USC00514830'),
     ('USC00519397', 'USC00517948'),
     ('USC00519397', 'USC00518838'),
     ('USC00519397', 'USC00519523'),
     ('USC00519397', 'USC00519281'),
     ('USC00519397', 'USC00511918'),
     ('USC00519397', 'USC00516128'),
     ('USC00519397', 'USC00519397')]




```python
# What are the most active stations?
# List the stations and the counts in descending order.
#func.max, func.avg, and func.count 
from sqlalchemy import desc
station_count = [Measurement.station,
                func.count(Measurement.station).label("for_count")]

active_stations_desc = session.query(*station_count).\
                        group_by(Measurement.station).\
                        order_by(desc("for_count")).all()
        
active_stations_desc

```




    [('USC00519281', 2772),
     ('USC00519397', 2724),
     ('USC00513117', 2709),
     ('USC00519523', 2669),
     ('USC00516128', 2612),
     ('USC00514830', 2202),
     ('USC00511918', 1979),
     ('USC00517948', 1372),
     ('USC00518838', 511)]




```python
# Using the station id from the previous query, creating obejct
(station_max, count_max) = active_stations_desc[0]
print(station_max, count_max)
```

    USC00519281 2772
    


```python
# Using the station id from the previous query, calculate the lowest temperature recorded, 
# highest temperature recorded, and average temperature most active station?

temp_stats = session.query(func.min(Measurement.tobs), 
                           func.avg(Measurement.tobs),
                           func.max(Measurement.tobs)).\
                           filter(Measurement.station == station_max).\
                            all()
        
temp_stats
        

```




    [(54.0, 71.66378066378067, 85.0)]




```python
# Choose the station with the highest number of temperature observations.
# Query the last 12 months of temperature observation data for this station and plot the results as a histogram

```


```python
# Write a function called `calc_temps` that will accept start date and end date in the format '%Y-%m-%d' 
# and return the minimum, average, and maximum temperatures for that range of dates
def calc_temps(start_date, end_date):
    """TMIN, TAVG, and TMAX for a list of dates.
    
    Args:
        start_date (string): A date string in the format %Y-%m-%d
        end_date (string): A date string in the format %Y-%m-%d
        
    Returns:
        TMIN, TAVE, and TMAX
    """
    
    return session.query(func.min(Measurement.tobs), func.avg(Measurement.tobs), func.max(Measurement.tobs)).\
        filter(Measurement.date >= start_date).filter(Measurement.date <= end_date).all()
print(calc_temps('2012-02-28', '2012-03-05'))
```


```python
# Use your previous function `calc_temps` to calculate the tmin, tavg, and tmax 
# for your trip using the previous year's data for those same dates.

```


```python
# Plot the results from your previous query as a bar chart. 
# Use "Trip Avg Temp" as your Title
# Use the average temperature for the y value
# Use the peak-to-peak (tmax-tmin) value as the y error bar (yerr)

```


```python
# Calculate the rainfall per weather station for your trip dates using the previous year's matching dates.
# Sort this in descending order by precipitation amount and list the station, name, latitude, longitude, and elevation


```

## Optional Challenge Assignment


```python
# Create a query that will calculate the daily normals 
# (i.e. the averages for tmin, tmax, and tavg for all historic data matching a specific month and day)

def daily_normals(date):
    """Daily Normals.
    
    Args:
        date (str): A date string in the format '%m-%d'
        
    Returns:
        A list of tuples containing the daily normals, tmin, tavg, and tmax
    
    """
    
    sel = [func.min(Measurement.tobs), func.avg(Measurement.tobs), func.max(Measurement.tobs)]
    return session.query(*sel).filter(func.strftime("%m-%d", Measurement.date) == date).all()
    
daily_normals("01-01")
```


```python
# calculate the daily normals for your trip
# push each tuple of calculations into a list called `normals`

# Set the start and end date of the trip

# Use the start and end date to create a range of dates

# Stip off the year and save a list of %m-%d strings

# Loop through the list of %m-%d strings and calculate the normals for each date

```


```python
# Load the previous query results into a Pandas DataFrame and add the `trip_dates` range as the `date` index

```


```python
# Plot the daily normals as an area plot with `stacked=False`

```
